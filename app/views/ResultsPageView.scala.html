@*
 * Copyright 2022 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import connectors.sharedmodel._
@import uk.gov.hmrc.govukfrontend.views.html.components._

@this(
        layout: templates.Layout,
        govukButton: GovukButton,
        govukPanel : GovukPanel
)

@(marginalReliefResult: MarginalReliefResult)(implicit request: Request[_], messages: Messages)

@displayResults(corporationTaxBeforeMR: Double, effectiveTaxRateBeforeMR: Double, corporationTax: Double, effectiveTaxRate: Double, marginalRelief: Double) = {
    <span>
        @govukPanel(Panel(
            title = Text("Marginal Relief for your accounting period is"),
            content = HtmlContent(s"£$marginalRelief")
        ))
        <h2 class="govuk-heading-m">Your Corporation Tax after Marginal Relief:</h2>
        <h2 class="govuk-heading-m">£@corporationTax</h2>
        <p class="govuk-body">Corporation Tax liability<br>
            Reduced from £@corporationTaxBeforeMR after £@marginalRelief Marginal Relief
        </p>
        <h2 class="govuk-heading-m">@effectiveTaxRate%</h2>
        <p class="govuk-body">Effective tax rate after Marginal Relief<br>
            Reduced from @effectiveTaxRateBeforeMR%
        </p>
    </span>
}

@layout(pageTitle = titleNoForm(messages("resultsPage.title"))) {

        @marginalReliefResult match {
            case SingleResult(corporationTaxBeforeMR, effectiveTaxRateBeforeMR, corporationTax, effectiveTaxRate, marginalRelief) => {
                @displayResults(corporationTaxBeforeMR, effectiveTaxRateBeforeMR, corporationTax, effectiveTaxRate, marginalRelief)
            }
            case r: DualResult => {
                @displayResults(r.totalCorporationTaxBeforeMR, r.effectiveTaxRateBeforeMR, r.totalCorporationTax, r.effectiveTaxRate, r.totalMarginalRelief)
            }
        }

}
